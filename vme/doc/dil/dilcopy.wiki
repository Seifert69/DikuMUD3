= dilcopy =
 function: '''dilcopy'''(template_name : string, unit : unitptr) : unitptr;

The '''dilcopy''' function creates and attaches a new DIL program instance to a unit using a specified template.

== Description ==
The dilcopy function creates and attaches a new DIL program instance to a unit using a specified template. This enables modular DIL programming where multiple instances of the same DIL program can be attached to different units, each running independently with its own context and variables.

== Parameters ==
{| class="wikitable"
! Parameter !! Type !! Description
|-
| template_name || string || The name of the DIL template to copy
|-
| unit || unitptr || The unit to attach the new DIL program to
|}

== Return Value ==
Returns a unit pointer:
* '''unitptr''' - Pointer to the newly created DIL program instance
* '''null''' - If the template was not found or copy failed

== Examples ==
=== Basic Program Copy ===
 dilbegin copy_guard();
 var
    new_guard : unitptr;
 code
 {
    new_guard := dilcopy("guard_template", self);
    
    if (new_guard) {
       link(new_guard, self);
       act("New guard created and linked to you.", A_ALWAYS, self, null, null, TO_CHAR);
    } else {
       act("Failed to create guard.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

=== Multiple Program Instances ===
 dilbegin create_patrol();
 var
    i : integer;
    new_guard : unitptr;
 code
 {
    for (i := 0; i < 3; i := i + 1) {
       new_guard := dilcopy("guard_template", self);
       
       if (new_guard) {
          link(new_guard, self);
          act("Guard " + itoa(i + 1) + " created.", A_ALWAYS, self, null, null, TO_CHAR);
       } else {
          act("Failed to create guard " + itoa(i + 1) + ".", A_ALWAYS, self, null, null, TO_CHAR);
       }
    }
    
    act("Patrol created with " + itoa(i) + " guards.", A_ALWAYS, self, null, null, TO_CHAR);
    quit;
 } dilend

=== Program with Arguments ===
 dilbegin custom_guard();
 var
    new_guard : unitptr;
    guard_name : string;
 code
 {
    guard_name := argument;
    
    if (guard_name != "") {
       new_guard := dilcopy("guard_template", self);
       
       if (new_guard) {
          // Set custom name
          new_guard.title := "Guard " + guard_name;
          link(new_guard, self);
          act("Custom guard '" + guard_name + "' created.", A_ALWAYS, self, null, null, TO_CHAR);
       } else {
          act("Failed to create custom guard.", A_ALWAYS, self, null, null, TO_CHAR);
       }
    } else {
       act("No guard name specified.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

=== Independent Program ===
 dilbegin independent_program();
 var
    new_program : unitptr;
 code
 {
    new_program := dilcopy("independent_npc", self);
    
    if (new_program) {
       link(new_program, self.outside);
       act("Independent NPC program created.", A_ALWAYS, self, null, null, TO_CHAR);
    } else {
       act("Failed to create independent program.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

== Usage Notes ==
* The template name must be a valid DIL template that exists in the zone
* The new DIL program runs independently with its own execution context
* Multiple instances of the same template can be attached to different units
* The copied program inherits all properties and DIL code from the template
* Each instance has its own variable space and execution state
* Commonly used for creating multiple NPCs with similar behavior
* The function enables modular and reusable DIL programming

== Error Handling ==
The function performs validation:
* '''Template validation''' - Ensures template name exists in zone
* '''Unit validation''' - Ensures unit is a valid unit pointer
* '''Copy validation''' - Validates that the copy operation succeeds
* '''Security check''' - Prevents unauthorized template copying

== Related Functions ==
* [[Manual:DIL_Manual/dilcall|dilcall]] - Call DIL templates dynamically
* [[Manual:DIL_Manual/dilfind|dilfind]] - Find DIL programs on units
* [[Manual:DIL_Manual/dildestroy|dildestroy]] - Destroy DIL programs
* [[Manual:DIL_Manual/link|link]] - Move units between locations

== See Also ==
* [[Manual:DIL_Manual/DIL templates|DIL templates]] - Template system and modular programming
* [[Manual:DIL_Manual/dynamic programming|dynamic programming]] - Runtime code generation and execution
* [[Manual:DIL_Manual/modular design|modular design]] - Reusable program components