{
    "keyword": "sendto",
    "opcode": "DILSI_SNT",
    "yacc_rule": "| DILSI_SNT '(' coreexp ',' coreexp ')' ihold\n{\n    if ($3.typ != DilVarType_e::DILV_SP)\n    {\n        dilfatal(\"Arg 1 of 'sendto' not a string\");\n    }\n    else if ($5.typ != DilVarType_e::DILV_UP)\n    {\n        dilfatal(\"Arg 2 of 'sendto' not a unit\");\n    }\n    else\n    {\n        $$.fst = $3.fst;\n        $$.lst = $7 + 1;\n        wtmp = &tmpl.core[$7];\n        bwrite_ubit8(&wtmp, DILI_SNT);\n    }\n}",
    "dilfe_name": "dilfi_snt",
    "c_implementation": "void dilfi_snt(dilprg *p)\n{\n    /* sendto (string, uptr) */\n    dilval *v2 = p->stack.pop();\n    dilval *v1 = p->stack.pop();\n\n    p->waitcmd--;\n\n    if (dil_type_check(\"sendto\", p, 2, v1, TYPEFAIL_NULL, 1, DILV_SP, v2, FAIL_NULL, 1, DILV_UP))\n    {\n        if (v1->val.ptr && v2->val.ptr)\n        {\n            spec_arg sarg;\n\n            sarg.activator = p->sarg->owner;\n            sarg.medium = nullptr;\n            sarg.target = nullptr;\n            sarg.pInt = nullptr;\n            sarg.fptr = nullptr; /* Set by unit_function_scan */\n            sarg.cmd = &g_cmd_auto_msg;\n            sarg.arg = (char *)v1->val.ptr;\n            sarg.mflags = SFB_MSG | SFB_AWARE;\n\n            unit_function_scan((unit_data *)v2->val.ptr, &sarg);\n\n            dil_test_secure(p);\n        }\n    }\n    delete v1;\n    delete v2;\n}",
    "dil_example": "dilbegin aware unique still_newbie();\ncode\n{\ninterrupt (SFB_CMD, ((command (\"level\")) and\n(activator==self)),lvl_check);\n:start:\nwait (SFB_DONE, command (\"say\") and\n  (activator==self) and\n((\"help me\" in argument) and\n(\"newbie guide\" in argument)));\nif ((self.outside.nameidx+\"@\"+self.outside.zoneidx)==\"nightmare@hobgob\")\ngoto start;\nsubextra(activator.quests, NO_NEWBIE);\nsendto(\"stillnewbie\", findroom(\"newbie_hangout@newbie\"));\ngoto start;\n:lvl_check:\nif (activator.level>5) quit;\ngoto start;\n} dilend"
}