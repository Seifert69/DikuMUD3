{
    "keyword": "prompt",
    "opcode": "DILSF_PROMPT",
    "yacc_rule": "| DILSF_PROMPT /* .prompt */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_SP;\n    $$.dsl = DSL_LFT;\n    $$.num = DILF_PROMPT;\n}",
    "dilfe_name": "DILF_PROMPT",
    "c_implementation": "case DILF_PROMPT:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                {\n                    auto *pc = reinterpret_cast<pc_data *>(v1->val.ptr);\n\n                    if (pc && pc->isPC())\n                    {\n                        v->atyp = DILA_NORM;\n                        v->type = DILV_SPR;\n                        v->ref = pc->getPromptStringPtr();\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL;\n                    }\n                }\n                break;\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin do_prompt(arg : string);\nexternal\n\tstring do_color@function(arg : string);\nvar\n\n   prom     :  string;\n   i:integer;\n\ncode\n{\n   if (self.type != UNIT_ST_PC)\n   {\n      sendtext(\"This command is for PC's only.<br/>\", self);\n      quit;\n   }\n\n   if (\"$noprompt\" in self.extra)\n   {\n      sendtext(\"You have lost the ability to set your prompt.<br/>\",self);\n      quit;\n   }\n\n   if (arg == \"\")\n   {\n      prom := \"Usage: prompt <prompt string><br/>\" + \n              \"Prompt string special identifiers, see help for more details<br/>\";\n      sendtext(prom, self);\n      quit;\n    }\n    \n   if (arg == \"show\")\n   {\n      sendtext(\"Your current prompt is :<br/><br/> \" +self.prompt+\"<br/>\", self);\n      /*log(self.name+\" shows their prompt as : \" +self.prompt+ \" <br/>\");*/\n      quit;\n   }\n\n   if (arg==\"default\")\n      self.prompt:= \"%mana%m/%endurance%e/%hp%h> \";\n   else if (arg==\"blank\")\n      self.prompt:= \"\";\n   else \n   {\n\t  arg := do_color@function(arg);\n      self.prompt := arg;\n   }\n   i:=dildestroy(\"send_prompt@update\",self);\n   dilcopy(\"send_prompt@update\",self);\n   quit;\n} dilend"
}