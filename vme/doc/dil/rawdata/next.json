{
    "keyword": "next",
    "opcode": "DILSF_NXT",
    "yacc_rule": "| DILSF_NXT /* .next */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UEZCP;\n    $$.typ = DilVarType_e::DILV_UEZCP;\n    $$.dsl = DSL_DYN;\n    $$.num = DILF_NXT;\n}",
    "dilfe_name": "DILF_NXT",
    "c_implementation": "case DILF_NXT:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL:\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_EDP:\n                    v->atyp = DILA_NORM;\n                    v->type = DILV_EDP;\n                    if (v1->val.ptr)\n                    {\n                        v->val.ptr = ((extra_descr_data *)v1->val.ptr)->next;\n                    }\n                    else\n                    {\n                        v->val.ptr = nullptr;\n                    }\n                    break;\n                case DILV_UP:\n                {\n                    auto *unit = reinterpret_cast<unit_data *>(v1->val.ptr);\n                    if (unit)\n                    {\n                        v->atyp = DILA_NORM;\n                        v->type = DILV_UP;\n                        v->val.ptr = unit->getNext();\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                }\n                break;\n                case DILV_ZP:\n                    if (v1->val.ptr)\n                    {\n                        v->atyp = DILA_NORM;\n                        v->type = DILV_ZP;\n                        v->val.ptr = nullptr;\n\n                        zone_type *z = (zone_type *)v1->val.ptr;\n\n                        if (z)\n                        {\n                            auto it = g_zone_info.mmp.find(z->getName());\n                            if (it != g_zone_info.mmp.end())\n                            {\n                                it++;\n                                if (it != g_zone_info.mmp.end())\n                                {\n                                    v->val.ptr = it->second;\n                                }\n                            }\n                        }\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                    break;\n                case DILV_CP:\n                    if (v1->val.ptr)\n                    {\n                        v->atyp = DILA_NORM;\n                        v->type = DILV_CP;\n                        v->val.ptr = ((command_info *)v1->val.ptr)->next;\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                    break;\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin jailmaintain(maintainer : string, inroom : string);\nvar\n  newu : unitptr;\n  u : unitptr;\n  v : unitptr;\ncode\n{\n   :loop:\n   wait(SFB_MSG, argument == \"jailfood\");\n\n   u := findsymbolic(maintainer);\n\n   if (findroom(inroom) == u.outside)\n   {\n      v := u.inside;\n\n      while (v)\n      {\n\t if ((v.objecttype == ITEM_FOOD) or (v.objecttype == ITEM_DRINKCON))\n\t {\n\t    /* Give this one to the poor bastard in the cell */\n\t    newu := load(v.nameidx + \"@\" + v.zoneidx );\n\t    link(newu, self);\n\t    act(\"The door is opened for a moment, and $2n is pushed in.\",\n\t\tA_SOMEONE, self.inside, newu, null, TO_ALL);\n\t }\n\t v := v.next;\n      }\n   }\n   goto loop;\n} dilend"
}