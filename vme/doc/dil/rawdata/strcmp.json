{
    "keyword": "strcmp",
    "opcode": "DILSE_STRCMP",
    "yacc_rule": "| DILSE_STRCMP '(' dilexp ',' dilexp ')'\n{\n    INITEXP($$);\n    $$.boolean = 1;\n    if ($3.typ != DilVarType_e::DILV_SP)\n    {\n        dilfatal(\"Arg 1 of 'strcmp' not string\");\n    }\n    else if ($5.typ != DilVarType_e::DILV_SP)\n    {\n        dilfatal(\"Arg 2 of 'strcmp' not string\");\n    }\n    else\n    {\n        /* Type is ok */\n        /* Function is not _yet_ static */\n        /* Make nodes dynamic */\n        $$.dsl = DSL_DYN;\n        $$.typ = DilVarType_e::DILV_INT;\n        make_code(&($3));\n        make_code(&($5));\n        add_code(&($$), &($3));\n        add_code(&($$), &($5));\n        add_ubit8(&($$), DILE_STRCMP);\n    }\n    FREEEXP($3);\n    FREEEXP($5);\n}",
    "dilfe_name": "dilfe_strcmp",
    "c_implementation": "void dilfe_strcmp(dilprg *p)\n{\n    dilval *v = new dilval;\n    /* String equal operator */\n    dilval *v2 = p->stack.pop();\n    dilval *v1 = p->stack.pop();\n\n    switch (dil_getval(v2))\n    {\n        case DILV_FAIL:\n            v->type = DILV_FAIL;\n            break;\n        case DILV_SP:\n            v->type = DILV_INT;\n            break;\n        case DILV_NULL:\n            v->type = DILV_NULL; /* null pointer */\n            break;\n        default:\n            v->type = DILV_ERR; /* wrong type */\n            break;\n    }\n\n    switch (dil_getval(v1))\n    {\n        case DILV_FAIL:\n            if (v->type != DILV_ERR)\n            {\n                v->type = DILV_FAIL;\n            }\n            break;\n        case DILV_SP:\n            break;\n        case DILV_NULL:\n            if ((v->type != DILV_ERR) && (v->type != DILV_FAIL))\n            {\n                v->type = DILV_NULL; /* null pointer */\n            }\n            break;\n        default:\n            v->type = DILV_ERR;\n            break;\n    }\n\n    switch (v->type)\n    {\n        case DILV_INT:\n            v->atyp = DILA_NONE;\n            v->val.num = strcmp((char *)v1->val.ptr, (char *)v2->val.ptr);\n            break;\n        case DILV_NULL:\n            v->atyp = DILA_NONE;\n            v->type = DILV_INT;\n            v->val.num = FALSE;\n            break;\n        default:\n            break;\n    }\n\n    p->stack.push(v);\n    delete v1;\n    delete v2;\n}",
    "dil_example": "dilbegin aware do_password(arg:string);\nvar\n   prmt:string;\n   firstpwd:string;\n   i:integer;\n   tlist:stringlist;\n\ncode\n{\n   if (excmdstr != \"password\")\n   {\n      sendtext (\"You must type 'password', no less to be able to set your password!<br/>\",self);\n      quit;\n   }\n\n   if (self.type != UNIT_ST_PC)\n      quit;\n\n   arg:=\"\";\n   prmt:=self.prompt;\n   self.prompt:=\"Enter new password:  \";\n   i:=dildestroy(\"send_prompt@update\",self);\n   dilcopy(\"send_prompt@update\",self);\n\n   wait(SFB_CMD, self==activator);\n   block;\n   tlist := getwords (excmdstr_case);\n\n   if (length(tlist) > 1)\n   {\n      sendtext (\"Password must be only one word.  Try again.<br/>\",self);\n      self.prompt:=prmt;\n      i:=dildestroy(\"send_prompt@update\",self);\n      dilcopy(\"send_prompt@update\",self);\n      quit;\n   }\n\n   if (length(excmdstr_case) < 5)\n   {\n      sendtext (\"Password to short. Password must be 5 characters or longer.  Try again.<br/>\",self);\n      self.prompt:=prmt;\n      i:=dildestroy(\"send_prompt@update\",self);\n      dilcopy(\"send_prompt@update\",self);\n      quit;\n   }\n\n   if (length(excmdstr_case) > 16)\n   {\n      sendtext (\"Password to long. Try again.<br/>\",self);\n      self.prompt:=prmt;\n      i:=dildestroy(\"send_prompt@update\",self);\n      dilcopy (\"send_prompt@update\",self);\n      quit;\n   }\n\n\tfirstpwd:=excmdstr_case;\n\tself.prompt:=\"Enter password again:  \";\n\n   wait (SFB_CMD,self==activator);\n   block;\n\n   if (strcmp(excmdstr_case,firstpwd)!=0)\n   {\n      sendtext (\"Passwords do not match try again.<br/>\",self);\n      self.prompt:=prmt;\n      i:=dildestroy(\"send_prompt@update\",self);\n      dilcopy (\"send_prompt@update\",self);\n      quit;\n   }\n\n   set_password(self,excmdstr_case);\n   sendtext (\"Password Changed.<br/>\",self);\n   self.prompt:=prmt;\n   i:=dildestroy(\"send_prompt@update\",self);\n   dilcopy(\"send_prompt@update\",self);\n   quit;\n} dilend"
}