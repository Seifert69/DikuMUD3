{
    "keyword": "dilfind",
    "opcode": "DILSE_DLF",
    "yacc_rule": "| DILSE_DLF '(' dilexp ',' dilexp ')'\n{\n    INITEXP($$);\n    if ($3.typ != DilVarType_e::DILV_SP)\n    {\n        dilfatal(\"Arg 1 of 'dilfind' not string\");\n    }\n    else if ($5.typ != DilVarType_e::DILV_UP)\n    {\n        dilfatal(\"Arg 2 of 'dilfind' not unitptr\");\n    }\n    else\n    {\n        /* Type is ok */\n        /* Make nodes dynamic */\n        $$.dsl = DSL_DYN;\n        $$.typ = DilVarType_e::DILV_INT;\n        make_code(&($3));\n        make_code(&($5));\n        add_code(&($$), &($3));\n        add_code(&($$), &($5));\n        add_ubit8(&($$), DILE_DLF);\n    }\n    FREEEXP($3);\n    FREEEXP($5);\n}",
    "dilfe_name": "dilfe_dlf",
    "c_implementation": "void dilfe_dlf(dilprg *p)\n{\n    dilval *v = new dilval;\n    /* Detection of DIL programs (TRUE/FALSE) */\n\n    dilval *v2 = p->stack.pop();\n    dilval *v1 = p->stack.pop();\n\n    v->type = DILV_INT;\n    switch (dil_getval(v2))\n    {\n        case DILV_UP:\n            switch (dil_getval(v1))\n            {\n                case DILV_SP:\n                    if (v1->val.ptr && v2->val.ptr)\n                    {\n                        v->atyp = DILA_NONE;\n                        if (dil_find((char *)v1->val.ptr, (unit_data *)v2->val.ptr))\n                        {\n                            v->val.num = TRUE;\n                        }\n                        else\n                        {\n                            v->val.num = FALSE;\n                        }\n                    }\n                    break;\n                case DILV_NULL:\n                case DILV_FAIL:\n                    v->type = DILV_FAIL;\n                    break;\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;\n        case DILV_NULL:\n        case DILV_FAIL:\n            v->type = DILV_FAIL;\n            break;\n        default:\n            v->type = DILV_ERR; /* wrong type */\n            break;\n    }\n\n    p->stack.push(v);\n    delete v1;\n    delete v2;\n}",
    "dil_example": "dilbegin look_signature();\nvar\n  pc:unitptr;\n  code\n  {\n  heartbeat:=PULSE_SEC*3;\n  :start:\n  wait (SFB_CMD,(\n  (command (\"look\")) and\n  ((\"signature\"==argument ) or (\"signatures\" == argument))\n  ));\n  block;\n  pc:=ghead();\nsendtext (\"The following book signers are on line.<br/><br/>\",activator);\n\n     while (pc.type==UNIT_ST_PC)\n      {\n      if (((isset (pc.pcflags,PC_PK_RELAXED)) or\n\t\t\t(dilfind (\"no_kill@function\",pc))) and\n      (pc.level<200) and\n      (visible (activator,pc)))\n     sendtext(pc.name+\" \"+pc.title+\"<br/>\",activator);\n      pc:=pc.gnext;\n      }\n\ngoto start;\n} dilend"
}