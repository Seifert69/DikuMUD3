{
    "keyword": "gprevious",
    "opcode": "DILSF_GPR",
    "yacc_rule": "| DILSF_GPR /* .gprevious */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_UP;\n    $$.dsl = DSL_DYN;\n    $$.num = DILF_GPR;\n}",
    "dilfe_name": "DILF_GPR",
    "c_implementation": "case DILF_GPR:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                {\n                    auto *unit = reinterpret_cast<unit_data *>(v1->val.ptr);\n                    if (unit)\n                    {\n                        v->atyp = DILA_NORM;\n                        v->type = DILV_UP;\n                        v->val.ptr = unit->getGlobalPrevious();\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                }\n                break;\n\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin color_bc();\n\nvar\n  pc     :unitptr;\n  newarg :string;\ncode\n{\n\theartbeat := PULSE_SEC;\n\t\n:start:\n\twait(SFB_CMD,((command(\"cb\")) and (activator.level>=242) and (activator==self.outside)));\n\tblock;\n\tpc:=activator;\n\tif ((\"\\\\\" in argument) and (activator.level<253))\n\t{\n\t\tact(\"You may not use newline characters!\",A_ALWAYS,pc,null,null,TO_CHAR);\n\t\tlog(pc.name + \" attempted to use newline characters in a \"\n\t\t\t+\"broadcast below level 253!\");\n\t\tgoto start;\n\t}\n\tif (\"\\\\\" in argument)\n\t{\n\t\tact(\"You may not change the background color, sorry.\",A_ALWAYS,pc,null,null,TO_CHAR);\n\t\tgoto start;\n\t}\n\tnewarg := argument;\n\tnewarg := replace(\"&lt;\",\"<\",newarg);\n\tnewarg := replace(\"&gt;\",\">\",newarg);\n\n\twhile (pc.gprevious.type==UNIT_ST_PC)\n\t\tpc := pc.gprevious;\n\n\twhile (pc.type==UNIT_ST_PC)\n\t{\n\t\tsendtext(newarg,pc);\n\t\tpc:=pc.gnext;\n\t}\n\tgoto start;\n} dilend"
}