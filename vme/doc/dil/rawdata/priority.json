{
    "keyword": "priority",
    "opcode": "DILSI_PRI",
    "yacc_rule": "| DILSI_PRI ihold\n{\n    $$.fst = $2;\n    $$.lst = $2 + 1;\n    wtmp = &tmpl.core[$2];\n    bwrite_ubit8(&wtmp, DILI_PRI);\n}",
    "dilfe_name": "dilfi_pri",
    "c_implementation": "void dilfi_pri(dilprg *p)\n{\n    p->waitcmd--;\n    p->sarg->fptr->setActivateOnEventFlag(SFB_PRIORITY);\n}",
    "dil_example": "dilbegin fnpri(FN_PRI_MISSION) unique to_the_rescue(sroomto : string);\nexternal\n   unitptr unit_room@function(u : unitptr);\n   integer walk_room@function (s:string,i:integer);\n\nvar \n   roomorg : string;\n   roomto  : string;\n   tf      : integer;\n   descorg : string;\n\ncode\n{\n   if (self.outside.type != UNIT_ST_ROOM)\n   {\n      act(\"$1n looks up, down, left, right. Pauses. Seems confused about $1s surroundings.\",\n            A_ALWAYS, self, null, null, TO_ALL);\n      quit;\n   }\n\n   roomorg := self.outside.symname;\n   descorg := self.outside_descr;\n   roomto  := sroomto;\n\n   :torescue:\n   priority;\n   self.outside_descr := sact(\"$1n is hurrying along.\", A_ALWAYS, self, null, null, TO_CHAR);\n   tf:=walk_room@function(roomto, 5);\n   self.outside_descr := sact(\"$1n is on the lookout.\", A_ALWAYS, self, null, null, TO_CHAR);\n\n   // Stay a little\n   act(\"$1n alertly scans $1s surroundings.\",A_ALWAYS, self, null, null, TO_ALL);\n   heartbeat := PULSE_SEC*4;\n   nopriority;\n\n   :nowwhat:\n   // Let the other DIL programs take control (no priority above)\n   pause;\n   pause;\n   pause;\n   if (self.position == POSITION_FIGHTING)\n      goto nowwhat;\n\n   :gohome:\n   self.outside_descr := sact(\"$1n is trodding along.\", A_ALWAYS, self, null, null, TO_CHAR);\n   priority;\n   tf:=walk_room@function(roomorg, 8);\n   self.outside_descr := descorg;\n   nopriority;\n   return;\n} dilend"
}