{
    "keyword": "endurance",
    "opcode": "DILSF_END",
    "yacc_rule": "| DILSF_END /* .endurance */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_INT;\n    $$.dsl = DSL_LFT;\n    $$.num = DILF_END;\n}",
    "dilfe_name": "DILF_END",
    "c_implementation": "case DILF_END:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                {\n                    auto *character = reinterpret_cast<char_data *>(v1->val.ptr);\n                    if (character && character->isChar())\n                    {\n                        v->atyp = DILA_NONE;\n                        v->type = DILV_SINT2R;\n                        v->ref = character->getEndurancePtr();\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL;\n                    }\n                }\n                break;\n\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin nokill();\nvar\n pc      : unitptr;\n room    : unitptr;\n i       : integer;\n\ncode\n{\n heartbeat := 3 * PULSE_SEC;\n :start:\n wait(SFB_COM,  self.position == POSITION_FIGHTING);\n pc := self.fighting;\n if (pc.level > 200) goto start;\n secure(pc,gone);\n if (command(\"flee\"))\n  block;\n\nself.hp:= self.max_hp;\nact(\"$1n grabs a large oak staff from behind $1m.\", A_ALWAYS, self, null,\npc, TO_VICT);\nact(\"$1n grabs a large oak staff from behind $1m.\", A_ALWAYS, self, null,\npc, TO_NOTVICT);\nact(\"With a surprisingly swift move he swings, connecting with your head and\nknocking you unconscious!\", A_ALWAYS, self, null, pc, TO_VICT);\nact(\"With a surprisingly swift move he swings, smashing $3n in the head\nknocking $3m unconscious!\", A_SOMEONE, self, null, pc, TO_NOTVICT);\n\npc.hp:= 0;\npc.endurance:= 0;\nposition_update(pc);\n:gone:\nunsecure(pc);\ngoto start;\n} dilend"
}