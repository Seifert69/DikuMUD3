{
    "keyword": "baseweight",
    "opcode": "DILSF_BWT",
    "yacc_rule": "| DILSF_BWT /* .baseweight */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_INT;\n    $$.dsl = DSL_DYN;\n    //$$.dsl = DSL_LFT;\n    $$.num = DILF_BWT;\n}",
    "dilfe_name": "DILF_BWT",
    "c_implementation": "case DILF_BWT:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                    if (v1->val.ptr)\n                    {\n                        v->atyp = DILA_NONE;\n                        v->type = DILV_INT;\n                        v->val.num = ((unit_data *)v1->val.ptr)->getBaseWeight();\n\n                        // v->atyp = DILA_NONE;\n                        // v->type = DILV_SINT2R;\n                        // v->ref = &UNIT_BASE_WEIGHT((class unit_data *)v1->val.ptr);\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                    break;\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin unitptr decapCorpse(corpse : unitptr);\nexternal\n    integer hasRaceHead(crace : integer);\nvar\n    item      : unitptr;\n    reward_exp : extraptr;\n    nextdude   : extraptr;\n    temp_lst  : stringlist;\n    mobdescr  : string;\n    mobname   : string;\n    temp_str  : string;\n    test_expt : extraptr;\n    headless:string;\n    living_sym : string;\n    chk : integer;\n\ncode\n{\n    item := null;\n\n    if (corpse.type != UNIT_ST_OBJ)\n    {\n        log(\"Corpse to decap not an object\");\n        return (item);\n    }\n\n    if ((corpse.symname != \"corpse@death\"))\n    {\n        log(\"Corpse to decap not a corpse\");\n        return (item);\n    }\n\n    if (\"headless\" in corpse.outside_descr)\n    {\n        log(\"Corpse already headless\");\n        return (item);\n    }\n    \n    if (\"$headless\" in corpse.extra)\n    {\n        log(\"Corpse already headless\");\n        return (item);\n    }\n    \n    if (not hasRaceHead(corpse.value[4]))\n    {\n        log(\"Corpse race has no head\");\n        return (item);\n    }\n\n    living_sym := corpse.extra.[\"$living_sym\"].descr;\n    addextra(corpse.extra,{\"$headless\"},\"has been decaped\");\n    item := load(\"head@death\");\n    addextra(item.extra,{\"$head_time\"}, itoa(realtime));\n    addextra(item.extra,{\"$living_sym\"}, living_sym);\n    dilcopy(\"rot_head@death\", item);\n\n    // If corpse has a reward on it copy it to the head.\n    //\n    reward_exp := \"$reward\" in corpse.extra;\n    while (reward_exp)\n    {\n        nextdude := \"$reward\" in reward_exp.next;\n        addextra(item.extra, reward_exp.names,reward_exp.descr);\n        subextra(corpse.extra, \"$reward\");\n        reward_exp := nextdude;\n    }\n\n    item.minv := 200;\n    link(item, corpse.outside);\n\n    chk := (corpse.value[4]);\n    if ((chk > RACE_ARTHROPODA_MIN) and (chk <= RACE_ARTHROPODA_MAX)) \n    {\n        set_weight_base(item, corpse.baseweight/70);\n    }\n    else\n        set_weight_base(item, corpse.baseweight/30);\n\n    if (item.baseweight > 100)\n    {\n        set_weight_base(item, 100);\n    }\n\n    if (item.baseweight < 1)\n    {\n        set_weight_base(item, 1);\n    }\n\n    set_weight_base(item, item.baseweight);\n    item.minv := 0;\n    mobdescr :=corpse.outside_descr;\n    temp_str := getword(mobdescr);\n    mobname  := mobdescr;\n    temp_str := getword(mobname);\n    temp_str := getword(mobname);\n    if (temp_str != \"of\")\n\ttemp_str := getword(mobname);\n\n    item.outside_descr := \"The decapitated head of \" + mobname ;\n    item.title := \"The decapitated head of \" + left(mobname, length(mobname)-15);\n    addstring(item.names, \"head_of_\" + left(mobname, length(mobname)-15));\n    addextra(item.extra, {\"\"}, \"The head has been severed from the body\");\n    headless:=left(corpse.title,length(corpse.title)-6);\n    corpse.title:=headless+\"headless corpse\";\n    corpse.outside_descr:=\"The headless \"+ mobdescr;\n    addextra(corpse.extra, {\"\"}, \"The head has been severed from the body\");\n    item.value[2] := corpse.value[2];\n    item.value[3] := corpse.value[3];\n\n    return (item);\n} dilend"
}