{
    "keyword": "objectflags",
    "opcode": "DILSF_EFL",
    "yacc_rule": "| DILSF_EFL /* .objectflags */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_INT;\n    $$.dsl = DSL_LFT;\n    $$.num = DILF_EFL;\n}",
    "dilfe_name": "DILF_EFL",
    "c_implementation": "case DILF_EFL:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                {\n                    auto *object = reinterpret_cast<obj_data *>(v1->val.ptr);\n                    if (object && object->isObj())\n                    {\n                        v->atyp = DILA_NONE;\n                        v->type = DILV_UINT1R;\n                        v->ref = object->getObjectFlagsPtr();\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                }\n                break;\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin integer wear(ch : unitptr, obj : unitptr,\n                      keyword : integer, arg : string, err : integer,\n                      cmd_str : string);\nexternal\n\tunit_msg(ch : unitptr, obj : unitptr, ex_str : string,\n                  act_self : string, act_other : string);\n\tinteger hands_used(ch : unitptr);\n\tstring obj_wear_size(ch : unitptr, obj : unitptr, keyword : integer);\n\tinteger two_handed(i : integer);\n\tstring wear_rating(wpn:integer);\nvar\nerrstr : string;\nc : string;\nhands : integer;\ntwo : integer;\nrating : string;\ncode\n{\nerrstr := \"\";\nif ((obj.type != UNIT_ST_OBJ) or\n   (obj.equip))\n\treturn(FALSE);\n\nif (keyword == WEAR_UNUSED)\n{\n if (equipment(ch,WEAR_UNUSED))\n  sendtext(\"DOUBLE ERROR! UNUSED ALREADY USED! REPORT!<br/>\",ch);\n else\n  sendtext(\"UNUSED EQUIPMENT ERROR! Please report!<br/>\", ch);\n\n return(FALSE);\n}\nelse if ((keyword == WEAR_FINGER_L) or\n        (keyword == WEAR_FINGER_R))\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_FINGER))\n  errstr := \"You can't wear that on your finger.\";\n else if (not (equipment(ch,WEAR_FINGER_L)))\n {\n   c := obj_wear_size(ch,obj,keyword);\n\n   if (c != \"\")\n   {\n    act(\"$3n is $2t to fit on your finger.\",\n    \tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n   }\n\n   unit_msg(ch,obj,\"$wear\",\n            \"You put $2n on your left hand's ringfinger.\",\n            \"$1n puts $2n on $1s left hand's ringfinger.\");\n\n   addequip(obj,WEAR_FINGER_L);\n }\n else if (not (equipment(ch,WEAR_FINGER_R)))\n {\n   c := obj_wear_size(ch,obj,keyword);\n\n   if (c != \"\")\n   {\n    act(\"$3n is $2t to fit on your finger.\",\n    \tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n   }\n\n   unit_msg(ch,obj,\"$wear\",\n            \"You put $2n on your right hand's ringfinger.\",\n            \"$1n puts $2n on $1s right hand's ringfinger.\");\n\n   addequip(obj,WEAR_FINGER_R);\n }\n else\n   errstr := \"You're already using two rings.\";\n}\nelse if ((keyword == WEAR_NECK_1) or\n   (keyword == WEAR_NECK_2))\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_NECK))\n   errstr := \"You can't wear that around your neck.\";\n else if (not (equipment(ch,WEAR_NECK_1)))\n {\n   c := obj_wear_size(ch,obj,keyword);\n\n   if (c != \"\")\n   {\n    act(\"$3n is $2t to fit around your neck.\",\n    \tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n   }\n\n   unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n around your neck.\",\n\t\t    \"$1n wears $2n around $1s neck.\");\n\n    addequip(obj,WEAR_NECK_1);\n }\n else if (not (equipment(ch,WEAR_NECK_2)))\n {\n   c := obj_wear_size(ch,obj,keyword);\n\n   if (c != \"\")\n   {\n    act(\"$3n is $2t to fit around your neck.\",\n    \tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n   }\n\n   unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n around your neck.\",\n\t\t    \"$1n wears $2n around $1s neck.\");\n\n    addequip(obj,WEAR_NECK_2);\n }\n else\n   errstr := \"You can't wear any more around your neck.\";\n}\nelse if (keyword == WEAR_BODY)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_BODY))\n   errstr := \"You can't wear that on your body.\";\n else if (not (equipment(ch,WEAR_BODY)))\n {\n   c := obj_wear_size(ch,obj,keyword);\n\n   if (c != \"\")\n   {\n   act(\"$3n is $2t to fit your body.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n   return(FALSE);\n   }\n\n   unit_msg(ch, obj, \"$wear\",\n\t\t    \"You put $2n on your body.\",\n\t\t    \"$1n puts $2n on $1s body.\");\n\n   addequip(obj,WEAR_BODY);\n }\n else\n   errstr := \"You already wear something on your body.\";\n}\nelse if (keyword == WEAR_HEAD)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_HEAD))\n   errstr := \"You can't wear that on your head.\";\n else if (not (equipment(ch,WEAR_HEAD)))\n {\n   c := obj_wear_size(ch,obj,keyword);\n\n   if (c != \"\")\n   {\n   act(\"$3n is $2t to fit your head.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n   return(FALSE);\n   }\n\n   unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n on your head.\",\n\t\t    \"$1n wears $2n on $1s head.\");\n\n   addequip(obj,WEAR_HEAD);\n }\n else\n   errstr := \"You already wear something on your head.\";\n}\nelse if (keyword == WEAR_LEGS)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_LEGS))\n   errstr := \"You can't wear that on your legs.\";\n else if (not (equipment(ch,WEAR_LEGS)))\n {\n   c := obj_wear_size(ch,obj,keyword);\n\n   if (c != \"\")\n   {\n   act(\"$3n are $2t to fit your legs.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n   return(FALSE);\n   }\n\n   unit_msg(ch, obj, \"$wear\",\n\t\t    \"You put $2n on your legs.\",\n\t\t    \"$1n puts $2n on $1s legs.\");\n\n   addequip(obj,WEAR_LEGS);\n }\n else\n   errstr := \"You already wear something on your legs.\";\n}\nelse if (keyword == WEAR_FEET)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_FEET))\n   errstr := \"You can't wear that on your feet.\";\n else if (not (equipment(ch,WEAR_FEET)))\n {\n   c := obj_wear_size(ch,obj,keyword);\n\n   if (c != \"\")\n   {\n   act(\"$3n are $2t to fit your feet.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n   return(FALSE);\n   }\n\n   unit_msg(ch, obj, \"$wear\",\n\t\t    \"You put $2n on your feet.\",\n\t\t    \"$1n puts $2n on $1s feet.\");\n\n   addequip(obj,WEAR_FEET);\n }\n else\n   errstr := \"You already wear something on your feet.\";\n}\nelse if (keyword == WEAR_HANDS)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_HANDS))\n   errstr := \"You can't wear that on your hands.\";\n else if (not (equipment(ch,WEAR_HANDS)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n are $2t to fit your hands.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You start using $2n.\",\n\t\t    \"$1n starts using $2n.\");\n    addequip(obj,WEAR_HANDS);\n }\n else\n    errstr := \"You already wear something on your hands.\";\n}\nelse if (keyword == WEAR_ARMS)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_ARMS))\n   errstr := \"You can't wear that on your arms.\";\n else if (not (equipment(ch,WEAR_ARMS)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n are $2t to fit your arms.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n on your arms.\",\n\t\t    \"$1n wears $2n on $1s arms.\");\n    addequip(obj,WEAR_ARMS);\n }\n else\n    errstr := \"You already wear something on your arms.\";\n}\nelse if (keyword == WEAR_ABOUT)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_ABOUT))\n   errstr := \"You can't wear that about your body.\";\n else if (not (equipment(ch,WEAR_ABOUT)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit about your body.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wrap $2n about your body.\",\n\t\t    \"$1n wraps $2n about $1s body.\");\n    addequip(obj,WEAR_ABOUT);\n }\n else\n    errstr := \"You already wear something about your body.\";\n}\nelse if (keyword == WEAR_WAIST)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_WAIST))\n    errstr := \"You can't wear that about your waist.\";\n else if (not (equipment(ch,WEAR_WAIST)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit around your waist.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You strap $2n about your waist.\",\n\t\t    \"$1n straps $2n about $1s waist.\");\n    addequip(obj,WEAR_WAIST);\n }\n else\n    errstr := \"You already wear something about your waist.\";\n}\nelse if ((keyword == WEAR_WRIST_L) or\n        (keyword == WEAR_WRIST_R))\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_WRIST))\n    errstr := \"You can't wear that around your wrist.\";\n else if (not (equipment(ch,WEAR_WRIST_L)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit around your wrist.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n around your left wrist.\",\n\t\t    \"$1n wears $2n around $1s left wrist.\");\n    addequip(obj,WEAR_WRIST_L);\n }\n else if (not (equipment(ch,WEAR_WRIST_R)))\n {\n   c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit around your wrist.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n around your right wrist.\",\n\t\t    \"$1n wears $2n around $1s right wrist.\");\n    addequip(obj,WEAR_WRIST_R);\n }\n else\n    errstr := \"You already wear something around both your wrists.\";\n}\nelse if (keyword == WEAR_WIELD)\n{\n hands := hands_used(ch);\n if (obj)\n two := two_handed(obj.value[0]); \n else\n two := FALSE;\n\n if (not (obj.manipulate & MANIPULATE_WIELD))\n    errstr := \"You can't wield that.\";\n else if (hands >= 2)\n    errstr := \"You have no free hands.\";\n else if ((two == TRUE) and (hands > 0))\n    errstr := \"You need two free hands to wield this weapon.\";\n else if (not (equipment(ch,WEAR_WIELD)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to be wielded by you.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n\n    if (two == TRUE)\n     unit_msg(ch, obj, \"$wear\",\n\t\t      \"You wield $2n two-handedly.\",\n\t\t      \"$1n wields $2n two-handedly.\");\n    else\n     unit_msg(ch, obj, \"$wear\",\n\t\t      \"You wield $2n.\",\n\t\t      \"$1n wields $2n.\");\n\n    addequip(obj,WEAR_WIELD);\n\n    if ((ch.type == UNIT_ST_PC) and (obj.objecttype == ITEM_WEAPON))\n    {\n    rating := wear_rating(ch.weapons[obj.value[0]]);\n    act(\"$2t at fighting with $3n.\",\n    \tA_ALWAYS, ch, rating, obj, TO_CHAR);\n    }\n }\n else\n    errstr := \"You are already wielding something.\";\n}\nelse if (keyword == WEAR_HOLD)\n{\n hands := hands_used(ch);\n\n\n if (obj.objecttype == ITEM_WEAPON)\n    two := two_handed(obj.value[0]);\n else\n    two := FALSE;\n\n if (not (obj.manipulate & (MANIPULATE_HOLD|MANIPULATE_WIELD)))\n    errstr := \"You can't hold this.\";\n else if (hands >= 2)\n    errstr := \"Your hands are full.\";\n else if (not (equipment(ch,WEAR_HOLD)))\n {\n\n    if ((two == TRUE) and (hands > 0))\n    {\n     errstr := \"It requires two free hands to use!\";\n     goto err;\n    }\n\n    if (obj.objecttype == ITEM_WEAPON)\n    {\n\n      if (isset(obj.objectflags,OBJ_NO_DUAL))\n      {\n       errstr := \"This weapon is too large to be used as a second \"+\n\t\t \"weapon.\";\n       goto err;\n      }\n\n      c := obj_wear_size(ch,obj,keyword);\n\n      if (c != \"\")\n      {\n      act(\"$3n is $2t to be wielded by you.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n      return(FALSE);\n      }\n    }\n\n   unit_msg(ch, obj, \"$wear\",\n\t\t    \"You start holding $2n.\",\n\t\t    \"$1n starts holding $2n.\");\n\n   addequip(obj,WEAR_HOLD);\n }\n else\n   errstr := \"You are already holding something.\";\n}\nelse if (keyword == WEAR_SHIELD)\n{\n hands := hands_used(ch);\n\n if (not (obj.manipulate & MANIPULATE_WEAR_SHIELD))\n    errstr := \"You can't use that as a shield.\";\n else if (obj.objecttype != ITEM_SHIELD)\n    errstr := \"That is not a shield.\";\n else if (hands >= 2)\n    errstr := \"Your hands are full.\";\n else if (not (equipment(ch,WEAR_SHIELD)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n are $2t to fit your arms.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You strap $2n to your arm.\",\n\t\t    \"$1n straps $2n on $1s arm.\");\n    addequip(obj,WEAR_SHIELD);\n }\n else\n    errstr := \"You are already using a shield.\";\n}\nelse if (keyword == WEAR_CHEST)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_CHEST))\n    errstr := \"You can't wear that across your chest.\";\n else if (not (equipment(ch,WEAR_CHEST)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit your chest.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You strap $2n across your chest.\",\n\t\t    \"$1n straps $2n across $1s chest.\");\n    addequip(obj,WEAR_CHEST);\n }\n else\n    errstr := \"You already wear something across your chest.\";\n}\nelse if (keyword == WEAR_BACK)\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_BACK))\n    errstr := \"You can't wear that on your back.\";\n else if (not (equipment(ch,WEAR_BACK)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit on your back.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You strap $2n on your back.\",\n\t\t    \"$1n straps $2n around $1s back.\");\n    addequip(obj,WEAR_BACK);\n }\n else\n    errstr := \"You already wear something on your back.\";\n}\nelse if ((keyword == WEAR_EAR_L) or\n        (keyword == WEAR_EAR_R))\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_EAR))\n    errstr := \"You can't wear that on your ear.\";\n else if (not (equipment(ch,WEAR_EAR_L)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit your ear.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n on your left ear.\",\n\t\t    \"$1n wears $2n on $1s left ear.\");\n    addequip(obj,WEAR_EAR_L);\n }\n else if (not (equipment(ch,WEAR_EAR_R)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit your ear.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n on your right ear.\",\n\t\t    \"$1n wears $2n on $1s right ear.\");\n    addequip(obj,WEAR_EAR_R);\n }\n else\n    errstr := \"You can't wear anything else on your ear.\";\n}\nelse if ((keyword == WEAR_ANKLE_L) or\n        (keyword == WEAR_ANKLE_R))\n{\n if (not (obj.manipulate & MANIPULATE_WEAR_ANKLE))\n    errstr := \"You can't wear that on your ankle.\";\n else if (not (equipment(ch,WEAR_ANKLE_L)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit your ankle.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n around your left ankle.\",\n\t\t    \"$1n wears $2n around $1s left ankle.\");\n    addequip(obj,WEAR_ANKLE_L);\n }\n else if (not (equipment(ch,WEAR_ANKLE_R)))\n {\n    c := obj_wear_size(ch,obj,keyword);\n\n    if (c != \"\")\n    {\n    act(\"$3n is $2t to fit your ankle.\",\n\tA_ALWAYS, ch, c, obj, TO_CHAR);\n    return(FALSE);\n    }\n\n    unit_msg(ch, obj, \"$wear\",\n\t\t    \"You wear $2n around your right ankle.\",\n\t\t    \"$1n wears $2n around $1s right ankle.\");\n    addequip(obj,WEAR_ANKLE_R);\n }\n else\n    errstr := \"You can't wear anything else on your ankles.\";\n}\nelse if (keyword == -1)\n    errstr := \"Wear $2n where?\";\nelse if (keyword == -2)\n    errstr := \"You can not wear $2n.\";\nelse\n{\n    errstr := \"Unknown weartype for $2n. Please report.\";\n    log(\"Unknown type (\"+itoa(keyword)+\") called in wear.\");\n}\n\nif (errstr == \"\")\n{\n send_done(cmd_str,ch,obj,null,0,arg,null, CMD_AUTO_NONE);\n return(TRUE);\n}\n\n:err:\nif (err)\n{\n act(errstr, A_ALWAYS, ch, obj, null, TO_CHAR);\n return(FALSE);\n}\nelse return(FALSE);\n\n} dilend"
}