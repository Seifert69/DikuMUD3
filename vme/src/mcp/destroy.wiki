= destroy =
 function: '''destroy'''(unit : unitptr);

The '''destroy''' function permanently removes a unit from the game world.

== Description ==
The destroy function permanently removes a unit from the game world. The behavior depends on the type of unit being destroyed:

=== For Player Characters (PCs) ===
* The player is saved and ejected from the game
* The player's descriptor is closed
* All references to the unit are cleaned up
* The player's equipment is unequipped and dropped to the ground
* The player is removed from all containing units

=== For NPCs and Objects ===
* The unit is immediately removed from the game
* All references to the unit are cleaned up
* The unit is removed from memory
* The unit's equipment is dropped to the ground
* The unit is removed from all containing units

=== For Rooms ===
* The function will have no effect on room units
* Rooms cannot be destroyed using this function

== Parameters ==
{| class="wikitable"
! Parameter !! Type !! Description
|-
| unit || unitptr || The unit to remove from the game
|}

== Return Value ==
Returns an integer:
* '''1''' (TRUE) - If the unit was successfully destroyed
* '''0''' (FALSE) - If the unit was not found or destruction failed

== Examples ==
=== Basic Unit Destruction ===
 dilbegin destroy_item();
 var
    item : unitptr;
 code
 {
    item := findunit(self, "sword", FIND_UNIT_IN_ME, null);
    
    if (item) {
       destroy(item);
       act("You destroy the " + item.title + ".", A_ALWAYS, self, null, null, TO_CHAR);
    } else {
       act("No item found to destroy.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

=== NPC Removal ===
 dilbegin remove_npc();
 var
    npc : unitptr;
 code
 {
    npc := findunit(self, "guard", FIND_UNIT_SURRO, null);
    
    if (npc and npc.type == UNIT_ST_NPC) {
       destroy(npc);
       act("The guard disappears in a puff of smoke.", A_ALWAYS, self, null, null, TO_ROOM);
    } else {
       act("No guard found to remove.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

=== Player Logout ===
 dilbegin force_logout();
 var
    player : unitptr;
 code
 {
    player := activator;
    
    if (player and player.type == UNIT_ST_PC) {
       act("You are forcibly logged out.", A_ALWAYS, player, null, null, TO_CHAR);
       destroy(player);
    } else {
       act("No player found to logout.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

=== Conditional Destruction ===
 dilbegin conditional_destroy();
 var
    target : unitptr;
 code
 {
    target := findunit(self, argument, FIND_UNIT_SURRO, null);
    
    if (target) {
       if (target.type == UNIT_ST_OBJ) {
          destroy(target);
          act("You destroy the " + target.title + ".", A_ALWAYS, self, null, null, TO_CHAR);
       } else if (target.type == UNIT_ST_NPC) {
          act("You cannot destroy living beings.", A_ALWAYS, self, null, null, TO_CHAR);
       } else {
          act("You can only destroy objects and NPCs.", A_ALWAYS, self, null, null, TO_CHAR);
       }
    } else {
       act("No target found to destroy.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

== Usage Notes ==
* The destruction is permanent and cannot be undone
* For player characters, this is equivalent to force logout
* The function handles cleanup of all references to the destroyed unit
* Equipment is dropped to the ground before destruction
* The function performs security checks to prevent unauthorized destruction
* Use with caution - especially with player characters

== Error Handling ==
The function performs validation:
* '''Unit validation''' - Ensures unit is a valid unit pointer
* '''Security check''' - Prevents destruction of protected units
* '''Type validation''' - Returns fail if unit is not a valid type
* '''Permission check''' - Ensures caller has authority to destroy target

== Related Functions ==
* [[Manual:DIL_Manual/remove|remove]] - Remove units from rooms
* [[Manual:DIL_Manual/unequip|unequip]] - Remove equipment from characters
* [[Manual:DIL_Manual/logout|logout]] - Force player logout (safer alternative)

== See Also ==
* [[Manual:DIL_Manual/unitptr|unitptr]] - Unit pointer data type
* [[Manual:DIL_Manual/UNIT_ST_PC|UNIT_ST_PC]] - Player character unit type
* [[Manual:DIL_Manual/UNIT_ST_NPC|UNIT_ST_NPC]] - Non-player character unit type
* [[Manual:DIL_Manual/UNIT_ST_OBJ|UNIT_ST_OBJ]] - Object unit type
* [[Manual:DIL_Manual/UNIT_ST_ROOM|UNIT_ST_ROOM]] - Room unit type