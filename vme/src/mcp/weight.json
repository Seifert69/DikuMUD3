{
    "keyword": "weight",
    "opcode": "DILSF_WGT",
    "yacc_rule": "| DILSF_WGT /* .weight */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_INT;\n    $$.dsl = DSL_DYN;\n    //$$.dsl = DSL_LFT;\n    $$.num = DILF_WGT;\n}",
    "dilfe_name": "DILF_WGT",
    "c_implementation": "case DILF_WGT:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                    if (v1->val.ptr)\n                    {\n                        v->atyp = DILA_NONE;\n                        v->type = DILV_INT;\n                        v->val.num = ((unit_data *)v1->val.ptr)->getWeight();\n\n                        // v->atyp = DILA_NONE;\n                        // v->type = DILV_SINT2R;\n                        // v->ref = &UNIT_WEIGHT((class unit_data *)v1->val.ptr);\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                    break;\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin getfrom_safe(prisoner : unitptr);\nvar\n   vr : unitptr;\n   u : unitptr;\n   nextu : unitptr;\n   safe : unitptr;\n   i : integer;\n\ncode\n{\n   safe := findsymbolic(prisoner, \"safe@justice\", FIND_UNIT_IN_ME);\n   if (safe == null)\n   {\n      log(\"no safe found\");\n      return; // There was nothing stored\n   }\n\n   vr := findsymbolic(\"void@basis\");\n\n   link(safe, vr); // Place in room OK to mess up weight\n\n   i := 0;\n   u := safe.inside;\n\n   while (u)\n   {\n      nextu := u.next;\n\n      link(u, prisoner);\n      i := i + 1;\n\n      u := nextu;\n   }\n\n   act(\"You get your posessions back.\", A_SOMEONE, prisoner, null, null, TO_CHAR);\n\n   if (safe.inside == null)\n      destroy(safe);\n   else\n   {\n      // Shouldn't happen\n      link(safe, prisoner);\n      log(\"Safe not empty for \" + prisoner.name);\n   }\n\n   return;\n} dilend"
}