{
    "keyword": "ability_levels",
    "opcode": "DILSF_ABL_L",
    "yacc_rule": "| DILSF_ABL_L idx /* . ability_levels */\n{\n    INITEXP($$);\n    copy_code(&($$), &($2));\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_INT;\n    $$.dsl = DSL_LFT;\n    $$.num = DILF_ABL_L;\n    FREEEXP($2);\n}",
    "dilfe_name": "DILF_ABL_L",
    "c_implementation": "case DILF_ABL_L:\n            v2 = p->stack.pop(); /* evaluate index */\n            switch (dil_getval(v2))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n\n                case DILV_INT:\n                    v->type = DILV_INT;\n                    break;\n\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n\n            switch (dil_getval(v1))\n            {\n                case DILV_FAIL:\n                    if (v->type != DILV_ERR)\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                    break;\n                case DILV_UP:\n                    break;\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n\n            if (v->type == DILV_INT)\n            {\n                auto *pc = reinterpret_cast<pc_data *>(v1->val.ptr);\n                if (pc && pc->isPC() && is_in(v2->val.num, 0, ABIL_TREE_MAX - 1))\n                {\n                    if (p->frame[0].tmpl->zone->getAccessLevel() == 0)\n                    {\n                        v->atyp = DILA_NONE;\n                        v->type = DILV_UINT1R;\n                        v->ref = pc->getAbilityLevelAtIndexPtr(v2->val.num);\n                    }\n                    else\n                    {\n                        v->atyp = DILA_NONE;\n                        v->type = DILV_INT;\n                        v->val.num = pc->getAbilityLevelAtIndex(v2->val.num);\n                    }\n                }\n                else\n                {\n                    v->type = DILV_FAIL;\n                }\n            }\n            break;",
    "dil_example": "dilbegin not_used(arg : string);\ncode\n{\n   // The functions in comments here have not been used in any DIL program.\n   // I suppose they're considered obsolete until someone needs them\n   // and they get tested.\n   //\n   // buf := getcolor(\"&br\"); -- NOT USED ANYWHERE\n   // buf := addcolor(); --NOT USED ANYWHERE\n   // buf := delcolor(); --NOT USED ANYWHERE\n   // buf := changecolor(); --NOT USED ANYWHERE\n   // buf := getcmd(); --NOT USED ANYWHERE\n   // buf := clone(); --NOT USED ANYWHERE\n   // buf := global_head(); --NOT USED ANYWHERE\n   // buf := obj_head(); --NOT USED ANYWHERE\n   // buf := npc_head(); --NOT USED ANYWHERE\n   // buf := room_head(); --NOT USED ANYWHERE\n   // buf := zone_head(); --NOT USED ANYWHERE\n   // buf := command_head(); --NOT USED ANYWHERE\n   // buf := strncmp(); --NOT USED ANYWHERE\n   // buf := check_password(); --NOT USED ANYWHERE\n   // buf := acc_total(); --NOT USED ANYWHERE\n   // buf := loglevel(); --NOT USED ANYWHERE\n   // buf := spell_levels(); --NOT USED ANYWHERE\n   // buf := spell_costs(); --NOT USED ANYWHERE\n   // buf := hasfunc(); --NOT USED ANYWHERE\n   // buf := ability_levels(); --NOT USED ANYWHERE\n   // buf := ability_costs(); --NOT USED ANYWHERE\n   // buf := weapon_levels(); --NOT USED ANYWHERE\n   // buf := weapon_costs(); --NOT USED ANYWHERE\n   // buf := skill_levels(); --NOT USED ANYWHERE\n   // buf := skill_costs(); --NOT USED ANYWHERE\n   // buf := lastroom(); --NOT USED ANYWHERE\n   // buf := unit.objs(); --NOT USED ANYWHERE\n   // buf := unit.roomcount(); --NOT USED ANYWHERE\n   // buf := unit.objcount(); --NOT USED ANYWHERE\n   // buf := unit.npccount(); --NOT USED ANYWHERE\n   // buf := unit.resetmode(); --NOT USED ANYWHERE\n   // buf := unit.loadlevel(); --NOT USED ANYWHERE\n\n   quit;\n} dilend"
}