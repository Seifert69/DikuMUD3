= fighting =

== Description ==
The '''fighting''' field is a read-only unitptr field available on both player characters (PC) and non-player characters (NPC). It returns a pointer to the unit that the character is currently fighting. If the character is not in combat, this field returns null.

== Availability ==
This field is available when the unit type is:
* UNIT_ST_PC (Player Character)
* UNIT_ST_NPC (Non-Player Character)

== Usage ==
The fighting field provides access to the current combat opponent.

=== Syntax ===
  unit.fighting

=== Return Value ===
Returns a unitptr pointing to the current opponent, or null if not fighting.

== Example ==
 dilbegin check_combat_status(ch:unitptr);
 var
    opponent : unitptr;
 code
 {
    heartbeat:=3;
    if (ch.type != UNIT_ST_PC and ch.type != UNIT_ST_NPC)
       return;

    opponent := ch.fighting;
    
    if (opponent == null)
       sendtext(ch.name + " is not in combat.<br/>", self);
    else
       sendtext(ch.name + " is fighting " + opponent.name + ".<br/>", self);
    
    return;
 } dilend

== Combat Monitoring ==
The fighting field is commonly used with wait() statements to monitor combat events:

 dilbegin combat_watcher();
 var
    target : unitptr;
 code
 {
    heartbeat := PULSE_SEC;
    
    :loop:
    wait(SFB_DEAD, self.fighting != null);
    
    if (self.fighting != null)
    {
       target := self.fighting;
       sendtext("Combat ended with " + target.name + ".<br/>", self);
    }
    
    goto loop;
 } dilend

== Usage Notes ==
* The field is read-only and cannot be directly assigned
* Returns null when the character is not in combat
* Only works on character units (PC and NPC)
* Can be used to detect when combat starts or ends
* Useful for triggering events based on combat outcomes

== See Also ==
* [[set_fighting()]] - Function to initiate combat between units
* [[stop_fighting()]] - Function to end combat
* [[opponentcount]] - Number of opponents being fought
* [[position]] - Current position of the character