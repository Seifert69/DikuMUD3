= clone =
 function: '''clone'''(unit : unitptr) : unitptr;

The '''clone''' function creates an exact copy of an existing unit.

== Description ==
The clone function creates an exact copy of an existing unit and places it in the same location as the unit that initiated the cloning process. The cloned unit is a complete duplicate with all properties, attributes, and DIL programs of the original unit.

== Parameters ==
{| class="wikitable"
! Parameter !! Type !! Description
|-
| unit || unitptr || The unit to clone/copy
|}

== Return Value ==
Returns a unit pointer:
* '''unitptr''' - Pointer to the cloned copy of the original unit
* '''null''' - If cloning failed

== Examples ==
=== Basic Item Cloning ===
 dilbegin clone_item();
 var
    original_item, cloned_item : unitptr;
 code
 {
    original_item := findunit(self, "sword", FIND_UNIT_IN_ME, null);
    
    if (original_item) {
       cloned_item := clone(original_item);
       
       if (cloned_item) {
          act("You successfully clone $2t.", A_ALWAYS, self, cloned_item.title, null, TO_CHAR);
       } else {
          act("Failed to clone the item.", A_ALWAYS, self, null, null, TO_CHAR);
       }
    } else {
       act("You don't have that item.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

=== NPC Cloning ===
 dilbegin create_guard();
 var
    template_guard, new_guard : unitptr;
 code
 {
    template_guard := findunit(self, "guard_template", FIND_UNIT_WORLD, null);
    
    if (template_guard) {
       new_guard := clone(template_guard);
       
       if (new_guard) {
          link(new_guard, self);
          act("$1n appears suddenly!", A_ALWAYS, new_guard, null, null, TO_ROOM);
       }
    } else {
       act("Guard template not found.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

=== Mass Cloning ===
 dilbegin clone_multiple();
 var
    source_item, cloned_copy : unitptr;
    i : integer;
 code
 {
    source_item := findunit(self, "potion", FIND_UNIT_IN_ME, null);
    
    if (source_item) {
       for (i := 0; i < 5; i := i + 1) {
          cloned_copy := clone(source_item);
          
          if (not cloned_copy) {
             act("Cloning failed after " + itoa(i) + " copies.", A_ALWAYS, self, null, null, TO_CHAR);
             break;
          }
       }
       
       if (i >= 4) {
          act("You create multiple copies of the potion.", A_ALWAYS, self, null, null, TO_CHAR);
       }
    } else {
       act("No potion found to clone.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

=== Conditional Cloning ===
 dilbegin smart_clone();
 var
    target_unit, cloned_unit : unitptr;
 code
 {
    target_unit := findunit(self, "magic_orb", FIND_UNIT_WORLD, null);
    
    if (target_unit) {
       if (target_unit.type == UNIT_ST_OBJ) {
          cloned_unit := clone(target_unit);
          
          if (cloned_unit) {
             act("The magic orb duplicates itself!", A_ALWAYS, cloned_unit, null, null, TO_ROOM);
             set(cloned_unit.extra, EXTRA_NOSAVE);  // Make temporary
          }
       } else {
          act("Only objects can be cloned here.", A_ALWAYS, self, null, null, TO_CHAR);
       }
    } else {
       act("No target found for cloning.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

=== Temporary Clone ===
 dilbegin create_temp_copy();
 var
    original, temp_copy : unitptr;
 code
 {
    original := findunit(self, "scroll", FIND_UNIT_IN_ME, null);
    
    if (original) {
       temp_copy := clone(original);
       
       if (temp_copy) {
          set(temp_copy.extra, EXTRA_NOSAVE);
          act("You create a temporary copy of the scroll.", A_ALWAYS, self, temp_copy.title, null, TO_CHAR);
       }
    } else {
       act("Failed to create temporary copy.", A_ALWAYS, self, null, null, TO_CHAR);
    }
    quit;
 } dilend

== Usage Notes ==
* The cloned unit is automatically placed inside the unit that performed the clone operation
* All DIL programs on the cloned unit are activated after cloning
* The cloned unit is a complete duplicate with all original properties
* This function is useful for creating copies of items, NPCs, or other units
* The original unit remains unchanged
* Use EXTRA_NOSAVE flag to make cloned units temporary

== Error Handling ==
The function will return null if:
* The source unit pointer is null or invalid
* The cloning process fails due to system limitations
* Memory allocation fails for the new unit

== Related Functions ==
* [[Manual:DIL_Manual/load|load]] - Load a unit from database by name
* [[Manual:DIL_Manual/destroy|destroy]] - Remove a unit from the game
* [[Manual:DIL_Manual/link|link]] - Move a unit to a different location

== See Also ==
* [[Manual:DIL_Manual/unitptr|unitptr]] - Unit pointer data type
* [[Manual:DIL_Manual/EXTRA_NOSAVE|EXTRA_NOSAVE]] - Extra description flag for temporary units