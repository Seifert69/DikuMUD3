= can_carry =
function: [integer] '''can_carry'''(ch : unitptr, u : unitptr, n : integer);

Checks if a character can carry a specific number of items, testing both inventory count limits and weight constraints.

== Description ==
The '''can_carry''' function determines whether a character can carry a specified quantity of a particular item. It performs two separate checks: first testing if the character has enough inventory slots available, then checking if the additional weight would exceed the character's maximum carrying capacity. This function is commonly used for item pickup validation and inventory management before actually transferring items to a character.

== Parameters ==
{| class="wikitable"
! Parameter !! Type !! Description
|-
| ch || unitptr || The character to check carrying capacity for (must be a character unit)
|-
| u || unitptr || The item to check if the character can carry (any unit type)
|-
| n || integer || The number of copies of the item to check (must be 1 or greater)
|}

== Return Value ==
: integer
: Returns a status code indicating the result of the carry check:
:* 0 - Character can carry the specified quantity of items
:* 1 - Cannot carry due to inventory count limit (hands are full)
:* 2 - Cannot carry due to weight limit (too heavy)

== Examples ==
 dilbegin item_pickup_validation();
 var
  sword : unitptr;
  result : integer;
 code
 {
 :start:
 sword := findunit(self.outside, "sword", FIND_UNIT_SURRO, null);
 if (sword == null)
 {
   sendtext("No sword found here.<br/>", self);
   goto done;
 }
 
 result := can_carry(activator, sword, 1);
 
 if (result == 1)
   exec("say Your hands are full!", self);
 else if (result == 2)
   exec("say You can't carry that much weight.", self);
 else
   exec("give " + sword.name + " to " + activator.name, self);
 
 :done:
 } dilend

== Usage Notes ==
* The function checks count limits first, then weight limits
* Count limit is calculated as: 10 + (character dexterity / 10) items
* Weight limit is calculated as: 50 + MAX(50, base weight / 2) + strength * 2
* Only non-equipped items are counted toward the inventory limit
* Money items are excluded from the count calculation

== Error Handling ==
The function will fail with DILV_FAIL if:
* The first parameter (ch) is not a character unit or is null
* The second parameter (u) is null
* The third parameter (n) is less than 1

Type errors will occur if:
* Parameter 1 or 2 are not unitptr types
* Parameter 3 is not an integer type

== Related Functions/Fields ==
* [[Manual:DIL_Manual/capacity|capacity]] - Gets the maximum weight a unit can carry
* [[Manual:DIL_Manual/weight|weight]] - Gets the current weight of a unit
* [[Manual:DIL_Manual/fits|fits]] - Checks if an item fits in a specific equipment slot
* [[Manual:DIL_Manual/manipulate|manipulate]] - Field that controls item interaction permissions

== See Also ==
* [[Manual:DIL_Manual/char_can_carry_n|char_can_carry_n]] - Internal count limit function
* [[Manual:DIL_Manual/char_can_carry_w|char_can_carry_w]] - Internal weight limit function
* [[Manual:DIL_Manual/findunit|findunit]] - For locating items to check
* [[Manual:DIL_Manual/load|load]] - For creating new items to test carrying capacity