= unitdir =
 function: stringlist '''unitdir'''(match : string);

The '''unitdir''' function returns a list of unit files matching a pattern.

== Description ==
This function searches the units directory for files matching the specified pattern and returns them as a stringlist. The pattern parameter supports Linux-style wildcards including asterisk (*) for any characters, question mark (?) for single characters, and character classes ([...]). This function is commonly used for finding and loading unit files based on naming patterns.

== PARAMETERS ==
{| class="wikitable"
! Parameter !! Type !! Description
|-
| match || string || The wildcard pattern to match against filenames in the units directory
|}

== Examples ==
=== Basic Pattern Matching ===
dilbegin unique find_corpses();
var
    corpselist : stringlist;
    i : integer;
code
{
    // Find all files starting with "corpse"
    corpselist := unitdir("corpse*");
    
    sendto("Found " + itoa(length(corpselist)) + " corpse files:&n", self);
    
    // Process each corpse file
    for (i := 0; i < length(corpselist); i := i + 1)
    {
        sendto("  " + corpselist.[i] + "&n", self);
    }
} dilend

=== Load by Pattern ===
dilbegin unique load_by_pattern(pattern : string);
var
    filelist : stringlist;
    i : integer;
    unit : unitptr;
code
{
    // Get all files matching the pattern
    filelist := unitdir(pattern);
    
    if (length(filelist) == 0)
    {
        sendto("No files found matching pattern: " + pattern + "&n", self);
        quit;
    }
    
    sendto("Files matching '" + pattern + "':&n", self);
    for (i := 0; i < length(filelist); i := i + 1)
    {
        sendto("  " + filelist.[i] + "&n", self);
        
        // Restore the first matching file
        if (i == 0)
        {
            unit := restore(filelist.[i], null);
            if (unit != null)
            {
                sendto("  Restored: " + unit.name + "&n", self);
            }
        }
    }
} dilend

== Usage Notes ==
* The function searches the units subdirectory of the current zone's DIL file path.
* Pattern matching follows Linux shell wildcard rules:
** * - Matches any sequence of characters
** ? - Matches any single character  
** [...] - Matches any one of the enclosed characters
* The function returns a stringlist containing only the matching filenames (not full paths).
* Commonly used with [[restore]]() function to load matching unit files.
* If no files match the pattern, an empty stringlist is returned.
* The pattern matching is case-sensitive.
* Useful for batch operations on groups of related unit files.

== Error Handling ==
* If the match parameter is not a string, a DIL fatal error occurs: "Arg 1 of 'unitdir' not string".
* If the units directory doesn't exist or is inaccessible, the function returns an empty stringlist.
* If the pattern contains invalid regex syntax, the function may fail or return unexpected results.
* File system errors (permissions, etc.) will result in an empty stringlist being returned.

== Related Functions/Fields ==
* [[restore]] - Loads a unit from a file
* [[savestr]] - Saves string data to files
* [[loadstr]] - Loads string data from files
* [[delstr]] - Deletes files

== See Also ==
* File system functions
* Pattern matching functions
* Unit management functions