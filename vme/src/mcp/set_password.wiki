= set_password =
 function: void '''set_password'''(pc : unitptr, password : string);

The '''set_password''' function is used to set or change the password of a player character.

== Description ==
This function sets a new password for a player character. The password is encrypted using the system's crypt() function with the player's filename as the salt. This function only works on player characters (PC) and requires appropriate zone access level to execute.

The function includes security checks to prevent unauthorized password changes and will terminate the DIL program if access level requirements are not met.

== PARAMETERS ==
{| class="wikitable"
! Parameter !! Type !! Description
|-
| pc || unitptr || The player character whose password will be set
|-
| password || string || The new password to set (5-16 characters recommended)
|}

The pc parameter must be a valid player character unit. The password parameter should be a string containing the desired new password.

== Examples ==
=== Basic Password Change ===
 dilbegin change_my_password();
 var
    new_pwd : string;
 code
 {
    if (self.type != UNIT_ST_PC)
       quit;
    
    new_pwd := "newsecret123";
    set_password(self, new_pwd);
     sendtext("Your password has been changed.&n", self);
 } dilend

=== Password Change with Validation ===
 dilbegin secure_password_change();
 var
    first_pwd : string;
    second_pwd : string;
    original_prompt : string;
 code
 {
    if (self.type != UNIT_ST_PC)
       quit;
    
    original_prompt := self.prompt;
    
    // Get first password entry
    self.prompt := "Enter new password: ";
    wait(SFB_CMD, self == activator);
    block;
    
    first_pwd := excmdstr_case;
    
    // Validate password length
    if (length(first_pwd) < 5)
    {
        sendtext("Password too short. Must be 5+ characters.&n", self);
       self.prompt := original_prompt;
       quit;
    }
    
    if (length(first_pwd) > 16)
    {
        sendtext("Password too long. Maximum 16 characters.&n", self);
       self.prompt := original_prompt;
       quit;
    }
    
    // Get password confirmation
    self.prompt := "Enter password again: ";
    wait(SFB_CMD, self == activator);
    block;
    
    second_pwd := excmdstr_case;
    
    // Verify passwords match
    if (strcmp(first_pwd, second_pwd) != 0)
    {
        sendtext("Passwords do not match. Try again.&n", self);
       self.prompt := original_prompt;
       quit;
    }
    
    // Set the new password
    set_password(self, first_pwd);
     sendtext("Password successfully changed.&n", self);
    self.prompt := original_prompt;
 } dilend

=== Administrative Password Reset ===
 dilbegin admin_reset_password(target_name : string);
 external
    isplayer(name : string) : integer;
 var
    target_pc : unitptr;
 code
 {
    // Find the target player
    target_pc := findunit(self, target_name, UNIT_ST_PC);
    
    if (target_pc == null)
    {
        sendtext("Player '" + target_name + "' not found.&n", self);
       quit;
    }
    
    // Reset to a temporary password
    set_password(target_pc, "temp123");
     sendtext("Password for " + target_pc.name + " reset to 'temp123'.&n", self);
     sendtext("Please change it immediately.&n", target_pc);
 } dilend

== Usage Notes ==
* This function only works on player characters (UNIT_ST_PC)
* The function requires zone access level 0 (no restrictions) to execute
* Passwords are automatically encrypted using the player's filename as salt
* Recommended password length is 5-16 characters
* The function will terminate the DIL program if access level is insufficient
* Password changes are permanent and take effect immediately
* No confirmation is provided by the function itself - implement validation as needed

== Error Handling ==
The function includes several error checks:

* **Type validation**: If the first parameter is not a unitptr, the function fails with a fatal error
* **Unit type validation**: If the unit is not a player character, the function fails with a type error
* **Access level validation**: If the zone access level is greater than 0, the function logs a security violation and terminates the DIL program
* **Null pointer validation**: If either parameter is null, the function fails silently

Common error scenarios:
* Attempting to set password on NPC or object units
* Running from a zone with restricted access level
* Passing invalid unit pointers or null values

== Related Functions/Fields ==
* [[check_password()]] - Function to verify a player's password
* [[isplayer()]] - Function to check if a name belongs to a player
* [[UNIT_ST_PC]] - Player character unit type
* [[pcflags]] - Player configuration flags

== See Also ==
* [[excmdstr]] - Command string input from player
* [[excmdstr_case]] - Case-sensitive command string input
* [[strcmp()]] - String comparison function
* [[length()]] - String length function
