= check_password =

== Syntax ==
 check_password( u : unitptr, s : string ) : integer

== Parameters ==
; u : unitptr
: The player character unit whose password you want to check
; s : string
: The password string to verify against the player's password

== Return Value ==
Returns 1 (TRUE) if the password matches the player's password, 0 (FALSE) if it does not match.

== Description ==
The check_password function verifies whether a given password string matches the stored password of a player character. This function only works on player characters (PCs) and will fail if used on NPCs or other unit types.

The function uses the system's password comparison mechanism, which typically involves crypt() for secure password hashing and comparison. The actual password storage and comparison is handled securely by the underlying system.

== Usage Notes ==
* Only works on player characters (PCs) - will fail and log an error if used on NPCs
* The password comparison is secure and uses proper cryptographic hashing
* This function is commonly used for authentication and password verification systems
* The function returns a boolean result as an integer (TRUE/FALSE)

== Examples ==
=== Basic password verification ===
 if (not check_password(pc, arg))
 {
     sendtext(arg + " is not " + pc.name + "'s password.", self);
     quit;
 }

=== Authentication check ===
 dilbegin authenticate_player(target : unitptr, password : string);
 var
     authenticated : integer;
 code
 {
     authenticated := check_password(target, password);
     
     if (authenticated)
         act("Authentication successful for $1n.", A_ALWAYS, target, null, null, TO_ROOM);
     else
         act("Authentication failed for $1n.", A_ALWAYS, target, null, null, TO_ROOM);
     
     quit;
 } dilend

=== Password change verification ===
 dilbegin verify_old_password(new_pwd : string);
 var
     old_pwd : string;
 code
 {
     // Prompt for old password first
     self.prompt := "Enter your current password: ";
     wait(SFB_CMD, self == activator);
     block;
     
     old_pwd := excmdstr;
     
     if (not check_password(self, old_pwd))
     {
         sendtext("Incorrect password. Password change cancelled.<br/>", self);
         quit;
     }
     
     // Continue with password change process...
     sendtext("Password verified. Proceeding with password change.<br/>", self);
     quit;
 } dilend

== Error Conditions ==
The function will fail and return an error if:
* The target unit is not a player character
* The password string is null or invalid
* The unit pointer is null or invalid

== Security Considerations ==
* Passwords are stored using secure cryptographic hashing
* The function does not expose the actual stored password
* Password comparison is done securely using the system's pwdcompare function
* Always use this function rather than trying to compare passwords directly

== See Also ==
* [[set_password]] - Set or change a player's password
* [[isplayer]] - Check if a unit is a player character

== Implementation Details ==
The function uses the crypt() function with the player's filename as the salt to hash the provided password, then compares it with the stored hashed password using pwdcompare(). The comparison is done securely and the actual password is never exposed in plain text. The function enforces that only player characters can have their passwords checked.