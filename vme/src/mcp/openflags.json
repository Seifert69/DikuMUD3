{
    "keyword": "openflags",
    "opcode": "DILSF_OFL",
    "yacc_rule": "| DILSF_OFL /* .openflags */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_INT;\n    $$.dsl = DSL_LFT;\n    $$.num = DILF_OFL;\n}",
    "dilfe_name": "DILF_OFL",
    "c_implementation": "case DILF_OFL:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                {\n                    auto *unit = reinterpret_cast<unit_data *>(v1->val.ptr);\n                    if (unit)\n                    {\n                        /* ubit8 openflags */\n                        v->atyp = DILA_NONE;\n                        v->type = DILV_UINT1R;\n                        v->ref = unit->getOpenFlagsPtr();\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                }\n                break;\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin prg3();\nvar\n\tpc : unitptr;\n   gift: unitptr;\n    i  : integer;\n    il : intlist;\n\tbuf : string;\n\tsl  : stringlist;\n   gift1 : string;\ncode\n{\n\theartbeat := 3;\n\n\t:start:\n\n\twait(SFB_CMD, (command(\"open\")) and ((\"bag\" in argument)or\n\t(\"box\" in argument)or(\"treat\" in argument)) );\n\tpc := activator;\n\tsecure(pc, lost);\n\t{\n\t  block;\n\t  if (self.outside != activator)\n{\n      act(\"You must pick me up before opening me.\",\n          A_ALWAYS, activator, null, null, TO_CHAR);\ngoto start;\n}\t\t  \n  unset(self.openflags, EX_CLOSED);\n    \t  goto trap;\n    }\n:lost:\nact(\"<div class='cpr'>A possible rare item disappears forever!</div><div class='default'></div>\",\nA_SOMEONE, self, null, pc, TO_ALL);\ndestroy(self);\n\n:trap:\n      act(\"The bag rustles.\",\n          A_ALWAYS, pc, null, null, TO_ALL);\n       act(\"There is something inside - check your inventory!\",\n          A_ALWAYS, pc, null, null, TO_CHAR);\non rnd(0,7) goto load_1, load_2, load_3, load_4, load_5, load_6,load_7,load_8;\n/*loads*/\n:load_1:\ngift := load(\"juice@hallows23\");\nlink(gift,pc);\ndestroy(self);\n      pause;\n      quit;\n:load_2:\n     gift := load(\"pcookie@hallows23\");\nlink(gift,pc);\ndestroy(self);\n      pause;\n      quit;\n:load_3:\n     gift := load(\"pcorn@hallows23\");\nlink(gift,pc);\ndestroy(self);\n      pause;\n      quit;\n:load_4:\n     gift := load(\"mghost@hallows23\");\nlink(gift,pc);\ndestroy(self);\n      pause;\n      quit;\n:load_5:\n     gift := load(\"capple@hallows23\");\nlink(gift,pc);\ndestroy(self);\n      pause;\n      quit;\t\n:load_6:\n     gift := load(\"cider@hallows23\");\nlink(gift,pc);\ndestroy(self);\n      pause;\n      quit;\t\n:load_7:\n     gift := load(\"lbat@hallows23\");\nlink(gift,pc);\ndestroy(self);\n      pause;\n      quit;\n:load_8:\n     gift := load(\"dry_cran@hallows23\");\nlink(gift,pc);\ndestroy(self);\n      pause;\n      quit;\t  \t    \t  \t  \t    \t    \t     \n} dilend"
}