{
    "keyword": "remove",
    "opcode": "DILSI_REMLST",
    "yacc_rule": "| DILSI_REMLST '(' coreexp ',' coreexp ')' ihold\n{\n    if (($3.typ != DilVarType_e::DILV_SLP\n        && $3.typ != DilVarType_e::DILV_ILP)\n        || $3.dsl != DSL_LFT)\n    {\n        dilfatal(\"Arg 1 of 'remove' not a stringlist or intlist variable\");\n    }\n    else if ($5.typ != DilVarType_e::DILV_INT)\n    {\n        dilfatal(\"Arg 2 of 'remove' not an integer\");\n    }\n    else\n    {\n        $$.fst = $3.fst;\n        $$.lst = $7 + 1;\n        wtmp = &tmpl.core[$7];\n        bwrite_ubit8(&wtmp, DILI_REMLST);\n    }\n}",
    "dilfe_name": "dilfi_remlst",
    "c_implementation": "void dilfi_remlst(dilprg *p)\n{\n    dilval *v2 = p->stack.pop();\n    dilval *v1 = p->stack.pop();\n\n    p->waitcmd--;\n\n    switch (v1->type)\n    {\n        case DILV_FAIL:\n            break;\n\n        case DILV_SLPR:\n        case DILV_ILPR:\n            if (dil_type_check(\"remove\", p, 1, v2, TYPEFAIL_NULL, 1, DILV_INT))\n            {\n                if (v1->type == DILV_SLPR)\n                {\n                    ((cNamelist *)v1->ref)->Remove(v2->val.num);\n                }\n                else\n                {\n                    if (v1->type == DILV_ILPR)\n                    {\n                        ((cintlist *)v1->ref)->Remove(v2->val.num);\n                    }\n                }\n            }\n            break;\n\n        default:\n            /* ERROR not right lvalue */\n            dil_typeerr(p, \"lvalue substring\");\n            break;\n    }\n    delete v1;\n    delete v2;\n}",
    "dil_example": "dilbegin deengrave();\nexternal\n   integer IsInGuild@guilds(pc : unitptr, sGuild : string);\nvar\n    pc     : unitptr;\n \tting   : unitptr;\n \tpris   : integer;\n \ti      : integer;\n \ttext   : string;\n \tolddescr   : extraptr;\n\tcash   : string;\n\tengrv   : string;\n        engrvstr   :  stringlist;\n        newtitle   :  stringlist;\n        newdescr   :  stringlist;\ncode\n{\n    heartbeat := PULSE_SEC*4;\n\n:start:\n    wait(SFB_DONE,command(\"give\")and(self == target));\n    if(not visible(self,medium))goto start;\n    if(not visible(self,activator))\n    {\n        exec(\"sigh\",self);\n        exec(\"say How can I deal with someone I can't see?\", self );\n        exec(\"drop\"+medium.name,self);\n        goto start;\n    }\n    pc := activator;\n    ting := medium;\n    secure(pc,nopc);\n    secure(ting,ingenting);\n    dilcopy(\"busy@function(Please wait; I am working right now.)\",self);\n\n    if((ting.type != UNIT_ST_OBJ)or(ting.objecttype == ITEM_LIGHT)\n        or(ting.objecttype == ITEM_SCROLL)or(ting.objecttype == ITEM_FOOD)\n        or(ting.objecttype == ITEM_BOOK)or(ting.objecttype == ITEM_SPELL)\n        or(MAT_CLOTH_STR in ting.extra)or(MAT_FIRE_STR in ting.extra)or\n        ((ting.objecttype == ITEM_ARMOR)and(ting.value[0]==0)))\n    {\n        exec(\"say Sorry, it is beyond my ability to remove the engraving from this.\",self);\n:giveback:\n        unsecure(ting);\n        link(ting, pc);\n        act(\"$3n gives $2n to $1n.\",A_SOMEONE,pc,ting,self,TO_REST);\n        act(\"$3n gives $2n to you.\",A_SOMEONE,pc,ting,self,TO_CHAR);\n        i:=dildestroy(\"busy@function\",self);\n        unsecure (pc);\n        goto start;\n    }\n\n    if(not(\"engraving\" in ting.extra))\n    {\n        exec(\"say Hmm... this item doesn't have an engraving, \"+pc.name+\n        \".\",self);\n        goto giveback;\n    }\n\n    pause;\n    if (IsInGuild@guilds(pc, GUILD_UDG_THIEF)){ // thieves guild discount\n    \texec(\"wink \" + pc.name,self);\n    \tpris := (5*SILVER_MULT)+((ting.rent)*3);\n    }else{\n    \tpris := (5*PLATINUM_MULT)+((ting.rent)*3);\n    }\n    cash := moneystring(pris,TRUE);\n    exec(\"say Removing this engraving will cost you \"+cash+\".\",self);\n    pause;\n    if(not transfermoney(pc,self,pris))\n    {\n        exec(\"say ...which you don't have apparently.\",self);\n        exec(\"say Come back when you are richer, \"+pc.name+\".\",self);\n        goto giveback;\n    }\n    engrvstr := split(ting.extra.[\"engraving\"].descr, \"It says \");\n    newtitle := split(ting.title, \" (engraved: \" + engrvstr.[1] + \")\");\n\n    if (length(newtitle) == 2){\n\t    ting.title := newtitle.[0] + newtitle.[1];\n    }\n    else{\n    \t    ting.title := newtitle.[0];\n    }\n    subextra(ting.extra, \"engraving\");\n    olddescr := \"\" in ting.extra;\n    engrv := \"<br/>\" + engrvstr.[1] + \" is engraved on it.\";\n    newdescr := split(olddescr.descr, engrv);\n    if (length(newdescr) == 2){\n\t    olddescr.descr := newdescr.[0] + newdescr.[1];\n    }\n    else{\n    \t    olddescr.descr := newdescr.[0];\n    }\n\n    exec(\"say There, hope you like it, \" + pc.name + \"!\", self);\n    destroy(self.inside);\n    goto giveback;\n\n\n:nopc:\n    exec(\"shrug \",self);\n    exec(\"drop \"+ting.name,self);\n    i:=dildestroy(\"busy@function\",self);\n    unsecure(pc);\n    unsecure(ting);\n    goto start;\n\n:ingenting:\n    exec(\"say Huh? Where did that ting go?\",self);\n    I:=dildestroy(\"busy@function\",self);\n    unsecure(ting);\n    unsecure(pc);\n    goto start;\n\n} dilend"
}