{
    "keyword": "minv",
    "opcode": "DILSF_MIV",
    "yacc_rule": "| DILSF_MIV /* .minv */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_INT;\n    $$.dsl = DSL_LFT;\n    $$.num = DILF_MIV;\n}",
    "dilfe_name": "DILF_MIV",
    "c_implementation": "case DILF_MIV:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                {\n                    auto *unit = reinterpret_cast<unit_data *>(v1->val.ptr);\n                    if (unit)\n                    {\n                        v->atyp = DILA_NONE;\n                        v->type = DILV_UINT1R;\n                        v->ref = unit->getLevelOfWizardInvisibilityPtr();\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL;\n                    }\n                }\n                break;\n\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin putin_safe(prisoner : unitptr);\nvar\n   vr : unitptr;\n   u : unitptr;\n   nextu : unitptr;\n   safe : unitptr;\n   i : integer;\n\ncode\n{\n   vr := findsymbolic(\"void@basis\");\n   safe := load(\"safe@justice\");\n   link(safe, vr); // Place it in a room OK to mess up weight\n\n   i := 0;\n   u := prisoner.inside;\n\n   while (u)\n   {\n      nextu := u.next;\n\n      if (u.minv < 1)\n      {\n         link(u, safe);\n         i := i + 1;\n      }\n\n      u := nextu;\n   }\n\n   if (i < 1)\n   {\n      destroy(safe);\n   }\n   else\n   {\n      set_weight_base(safe, 0);\n      set_weight(safe, 0);\n      link(safe, prisoner);\n\n      if (safe == null)\n      {\n         act(\"$1n takes all $3n's possessions.\",\n            A_SOMEONE, self, null, prisoner, TO_NOTVICT);\n         act(\"$1n takes all your possessions.\",\n            A_SOMEONE, self, null, prisoner, TO_VICT);\n      }\n      else\n      {\n         act(\"$1n puts all $3n's possessions in the safe.\",\n            A_SOMEONE, self, safe, prisoner, TO_NOTVICT);\n         act(\"$1n puts all your possessions in the safe.\",\n            A_SOMEONE, self, safe, prisoner, TO_VICT);\n      }\n   }\n\n   return;\n} dilend"
}