{
    "keyword": "sex",
    "opcode": "DILSF_SEX",
    "yacc_rule": "| DILSF_SEX /* .sex */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_INT;\n    $$.dsl = DSL_LFT;\n    $$.num = DILF_SEX;\n}",
    "dilfe_name": "DILF_SEX",
    "c_implementation": "case DILF_SEX:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                {\n                    auto *character = reinterpret_cast<char_data *>(v1->val.ptr);\n                    if (character && character->isChar())\n                    {\n                        v->atyp = DILA_NONE;\n                        v->type = DILV_SINT1R;\n                        v->ref = character->getSexPtr();\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL;\n                    }\n                }\n                break;\n\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin ask_keeper3();\nvar\ns: string;\ncode\n{\non_activation(self.position==POSITION_FIGHTING,skip);\n\n        :start:\nwait(SFB_DONE,command(\"ask\")and(target==self)and(argument));\nif ((activator.sex==SEX_MALE)or(activator.sex==SEX_NEUTRAL)) s:=\"sir\";\nif (activator.sex==SEX_FEMALE) s:=\"madam\";\nif (\"pipe\" in argument)\n{\nexec(\"smile\",self);\nexec(\"say Aaah, my pipes are of the best quality, guaranteeing hours of \"+\n\"smoking pleasure, \"+s+\".\",self);\ngoto start;\n}\nif((\"pouch\"in argument)or(\"tobacco\" in argument))\n{\nexec(\"emote nods slightly.\",self);\nexec(\"say Only the finest of the gnomish tobacco sorts are used for my \"+\n\"blends, \"+s+\".\",self);\ngoto start;\n}\nif (\"cigar\" in argument)\n{\nexec(\"say Manufactured of the best tobacco leaves available, I have \"+\n\"cigars in every price category.\",self);\nexec(\"whisper \"+activator.name+\" ...although I might suggest the fine \"+\n\"cigars myself, \"+s+\".\",self);\nexec(\"say The enjoyment is unsurpassed.\",self);\nexec(\"emote smiles slightly.\",self);\ngoto start;\n}\nexec(\"say Uhm, are you sure, you saw it in my store, \"+s+\"?\",self);\ngoto start;\n} dilend"
}