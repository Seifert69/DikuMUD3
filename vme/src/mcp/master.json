{
    "keyword": "master",
    "opcode": "DILSF_MAS",
    "yacc_rule": "| DILSF_MAS /* .master */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_UP;\n    $$.dsl = DSL_DYN;\n    $$.num = DILF_MAS;\n}",
    "dilfe_name": "DILF_MAS",
    "c_implementation": "case DILF_MAS:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                {\n                    auto *character = reinterpret_cast<char_data *>(v1->val.ptr);\n                    if (character && character->isChar())\n                    {\n                        v->atyp = DILA_NORM;\n                        v->type = DILV_UPR;\n                        v->ref = character->getMasterPtr();\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL;\n                    }\n                }\n                break;\n\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin fnpri(FN_PRI_RESCUE-1) aware unique cuffed(depname : string);\nvar\n   cuffs  : unitptr;\n   deputy : unitptr;\n   i      : integer;\ncode\n{\n   cuffs := equipment(self, WEAR_WRIST_R);\n   secure(cuffs, broken);\n\n   deputy := self.master;\n   secure(deputy, broken);\n\n   if ((deputy == null) or (cuffs == null))\n   {\n      log(\"Cuffed lost either deputy or cuffs\");\n      goto broken;\n   }\n\n   heartbeat := PULSE_SEC * 1;\n\n   :loop:\n   if (cuffs.equip != WEAR_WRIST_R)\n     goto broken;\n   priority;\n   wait(SFB_TICK|SFB_CMD, activator == self);\n   goto loop;\n\n   :broken:\n   i := dildestroy(\"cuffed2@midgaard\", self);\n   quit;\n} dilend"
}