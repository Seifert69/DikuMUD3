{
    "keyword": "max_hp",
    "opcode": "DILSF_MHP",
    "yacc_rule": "| DILSF_MHP /* .max_hp */\n{\n    INITEXP($$);\n    $$.rtyp = DilVarType_e::DILV_UP;\n    $$.typ = DilVarType_e::DILV_INT;\n    $$.dsl = DSL_LFT;\n    $$.num = DILF_MHP;\n}",
    "dilfe_name": "DILF_MHP",
    "c_implementation": "case DILF_MHP:\n            switch (dil_getval(v1))\n            {\n                case DILV_NULL: /* not applicable */\n                case DILV_FAIL:\n                    v->type = DILV_FAIL; /* not applicable */\n                    break;\n                case DILV_UP:\n                {\n                    auto *unit = reinterpret_cast<unit_data *>(v1->val.ptr);\n                    if (unit)\n                    {\n                        v->atyp = DILA_NONE;\n\n                        if (unit->isPC())\n                        {\n                            if (p->frame[0].tmpl->zone->getAccessLevel() != 0)\n                            {\n                                v->type = DILV_INT;\n                                v->val.num = unit->getMaximumHitpoints();\n                            }\n                            else\n                            {\n                                v->type = DILV_SINT4R;\n                                v->ref = unit->getMaximumHitpointsPtr();\n                            }\n                        }\n                        else\n                        {\n                            v->type = DILV_SINT4R;\n                            v->ref = unit->getMaximumHitpointsPtr();\n                        }\n                    }\n                    else\n                    {\n                        v->type = DILV_FAIL; /* not applicable */\n                    }\n                }\n                break;\n                default:\n                    v->type = DILV_ERR; /* wrong type */\n                    break;\n            }\n            break;",
    "dil_example": "dilbegin clone_attr(original : unitptr, tgt : unitptr);\nvar\n   i : integer;\ncode\n{\n\n   /* - - - Abilities - - - */\n\n   i := 0;\n\n   while (i < ABIL_TREE_MAX)\n   {\n      tgt.abilities[i] := original.abilities[i];\n      i := i + 1;\n   }\n\n   /* tgt.level   := original.level; */\n   /* tgt.max_hp := original.max_hp; */\n   tgt.hp     := original.hp;\n\n   /* - - - Spells - - - */\n\n   i := 0;\n\n   if (tgt.type == UNIT_ST_PC)\n   {\n      while (i < SPL_GROUP_MAX)\n      {\n         tgt.spells[i] := (3 * original.spells[i]) / 2;\n         i := i + 1;\n      }\n   }\n   else\n   {\n      while (i < SPL_GROUP_MAX)\n      {\n         tgt.spells[i] := original.spells[i];\n         i := i + 1;\n      }\n   }\n\n\n\n   /* - - - Weapons - - - */\n\n   i := 0;\n\n   if (tgt.type == UNIT_ST_PC)\n   {\n      while (i < WPN_GROUP_MAX)\n      {\n         tgt.weapons[i] := (3 * original.weapons[i]) / 2;\n         i := i + 1;\n      }\n   }\n   else\n   {\n      while (i < SPL_GROUP_MAX)\n      {\n         tgt.weapons[i] := original.weapons[i];\n         i := i + 1;\n      }\n   }\n\n   quit;\n} dilend"
}